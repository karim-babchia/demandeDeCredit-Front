<p-toast></p-toast>
<p-confirm-dialog></p-confirm-dialog>
<form>
  <p-fluid>
    <div class="flex justify-center mt-8">
      <div class="w-full  border border-gray-300 rounded-2xl p-8 shadow-lg bg-white dark:bg-surface-900">
        <div class="space-y-8">
          <div class="p-mb-3 flex justify-center gap-4">
            <button pButton type="button" label="Retour" icon="pi pi-arrow-left" iconPos="left" (click)="goBack()"
              class="p-button-secondary"
              style="border-radius: 12px; padding: 0.5rem 1.5rem; font-weight: 500;"></button>

            <button pButton type="button" label="Info Dossier et demandeur" (click)="selectFieldset(1)"
              [class.p-button-primary]="activeFieldset === 1" style="border-radius: 12px;"
              [class.p-button-secondary]="activeFieldset != 1"></button>
            <button pButton type="button" label="Info Lignes de credit" (click)="selectFieldset(2)"
              [class.p-button-primary]="activeFieldset === 2" style="border-radius: 12px;"
              [class.p-button-secondary]="activeFieldset != 2"></button>
          </div>
          <section [hidden]="activeFieldset!=1">
            <h2 class="text-2xl font-bold text-surface-900 dark:text-white mb-6">Informations sur dossier
            </h2>
            <div class="grid md:grid-cols-3 gap-6">
              <div class="flex flex-col">
                <label for="statut" class="mb-1 font-medium">Statut demande<span class="text-red-500">*</span></label>
                <input pInputText id="statut" name="statut" [(ngModel)]="this.dossier.status" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="assigneA" class="mb-1 font-medium">Assigné à<span class="text-red-500">*</span></label>
                <input pInputText id="assigneA" name="assigneA" [(ngModel)]="dossier.assigneA" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="agence" class="mb-1 font-medium">Code agence<span class="text-red-500">*</span></label>
                <input pInputText id="agence" name="agence" [(ngModel)]="this.dossier.agence" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="idDemande" class="mb-1 font-medium">Id demande<span class="text-red-500">*</span></label>
                <input pInputText id="idDemande" name="idDemande" [(ngModel)]="dossier.id" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="creePar" class="mb-1 font-medium">Créé par<span class="text-red-500">*</span></label>
                <input pInputText id="creePar" name="creePar" [(ngModel)]="dossier.creePar" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="dateCreation" class="mb-1 font-medium">Date de création<span
                    class="text-red-500">*</span></label>
                <p-date-picker id="dateCreation" name="dateCreation" [(ngModel)]="dateC" [variant]="'filled'"
                  [showIcon]="true" disabled required readonly dateFormat="dd/mm/yy"></p-date-picker>
              </div>
              <div class="flex flex-col">
                <label for="marche" class="mb-1 font-medium">Marché<span class="text-red-500">*</span></label>
                <input pInputText id="marche" name="marche" [(ngModel)]="dossier.marche" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="modifiePar" class="mb-1 font-medium">Modifié par<span class="text-red-500">*</span></label>
                <input pInputText id="modifiePar" name="modifiePar" [(ngModel)]="dossier.modifiePar" type="text"
                  disabled />
              </div>
              <div class="flex flex-col">
                <label for="dateModification" class="mb-1 font-medium">Date de modification<span
                    class="text-red-500">*</span></label>
                <p-date-picker id="dateModification" name="dateModification" [(ngModel)]="dossier.dateModification"
                  [showIcon]="true" disabled readonly></p-date-picker>
              </div>
              <div class="flex flex-col">
                <label for="idRelation" class="mb-1 font-medium">Id Relation<span class="text-red-500">*</span></label>
                <input pInputText id="idRelation" name="idRelation" [(ngModel)]="clt.idRelation" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="nom" class="mb-1 font-medium">Nom<span class="text-red-500">*</span></label>
                <input pInputText id="nom" name="nom" [(ngModel)]="clt.nom" type="text" disabled />
              </div>
              <div class="flex flex-col">
                <label for="prenom" class="mb-1 font-medium">Prenom<span class="text-red-500">*</span></label>
                <input pInputText id="prenom" name="prenom" [(ngModel)]="clt.prenom" type="text" disabled="true" />
              </div>
            </div>
          </section>

          <!-- Section: Profil demandeur -->
          <section [hidden]="activeFieldset!=1">
            <h2 class="text-2xl font-bold text-surface-900 dark:text-white mb-6">Profil demandeur</h2>

            <div class="grid md:grid-cols-3 gap-6">
              <div class="flex flex-col">
                <label for="idCompte" class="mb-1 font-medium">Id compte</label>
                <input pInputText id="idCompte" name="idCompte" type="text" [(ngModel)]="compte.id" disabled />
              </div>
              <div class="flex flex-col">
                <label for="dateOuverture" class="mb-1 font-medium">Date d'ouverture du compte</label>
                <input pInputText id="dateOuverture" name="dateOuverture" type="date" [(ngModel)]="compte.dateOuverture"
                  required [disabled]="consulter" />
              </div>
              <div class="flex flex-col">
                <label for="chapitreCompte" class="mb-1 font-medium">Chapitre Du Compte</label>
                <input pInputText id="chapitreCompte" name="chapitreCompte" type="text" [(ngModel)]="compte.chapitre"
                  disabled />
              </div>
              <div class="flex flex-col">
                <label for="typeDocument" class="mb-1 font-medium">Type document</label>
                <p-select id="typeDocument" name="typeDocument" [options]="documents" optionLabel="type"
                  optionValue="id" (onChange)="updateDocument($event.value)" placeholder="Choisir un type"
                  class="w-full" required [disabled]="consulter"></p-select>
              </div>
              <div class="flex flex-col">
                <label for="numeroDocument" class="mb-1 font-medium">N° document</label>
                <input pInputText id="numeroDocument" name="numeroDocument" type="text" [(ngModel)]="document.num"
                  disabled />
              </div>
              <div class="flex flex-col">
                <label for="dateDelivrance" class="mb-1 font-medium">Délivré le</label>
                <input pInputText id="dateDelivrance" name="dateDelivrance" type="date" [(ngModel)]="document.date"
                  disabled />
              </div>
              <div class="flex flex-col">
                <label for="sexe" class="mb-1 font-medium">Sexe</label>
                <p-select id="sexe" name="sexe" [(ngModel)]="clt.sexe" [options]="sexes" placeholder="Choisir un type"
                  class="w-full" required [disabled]="consulter"></p-select>
              </div>
              <div class="flex flex-col">
                <label for="situationFamiliale" class="mb-1 font-medium">Situation familiale</label>
                <p-select id="situationFamiliale" name="situationFamiliale" [(ngModel)]="clt.situationFamiliale"
                  [options]="situationsF" placeholder="Choisir un type" class="w-full" required
                  [disabled]="consulter"></p-select>
              </div>
              <div class="flex flex-col">
                <label for="dateNaissance" class="mb-1 font-medium">Date de naissance</label>
                <input pInputText id="dateNaissance" name="dateNaissance" type="date" [(ngModel)]="clt.dateDeNaissance"
                  required [disabled]="consulter" />
              </div>
              <div class="flex flex-col">
                <label for="pays" class="mb-1 font-medium">Pays</label>
                <input pInputText id="pays" name="pays" type="text" [(ngModel)]="clt.pay" disabled />
              </div>
              <div class="flex flex-col">
                <label for="gouvernorat" class="mb-1 font-medium">Gouvernorat</label>
                <input pInputText id="gouvernorat" name="gouvernorat" type="text" [(ngModel)]="clt.gouvernorat"
                  disabled />
              </div>
            </div>

            <div class="mt-6 grid grid-cols-1 gap-6">
              <div class="flex flex-col">
                <label for="adresse" class="mb-1 font-medium">Adresse</label>
                <textarea pTextarea id="adresse" name="adresse" [(ngModel)]="clt.adresse" required
                  [disabled]="consulter"></textarea>
              </div>
              <div class="flex flex-col">
                <label for="infosSupp" class="mb-1 font-medium">Infos supplémentaires</label>
                <textarea pTextarea id="infosSupp" name="infosSupp" [(ngModel)]="clt.infoComplementaires"
                  [disabled]="consulter"></textarea>
              </div>
            </div>
          </section>

          <!-- Section: Statut professionnel -->
          <section [hidden]="activeFieldset!=1">
            <h2 class="text-2xl font-bold text-surface-900 dark:text-white mb-6">Statut professionnel</h2>

            <div class="grid md:grid-cols-3 gap-6">
              <div class="flex flex-col">
                <label for="prof" class="mb-1 font-medium">Profession</label>
                <input pInputText id="prof" name="prof" type="text" required [(ngModel)]="clt.profession"
                  [disabled]="consulter" />
              </div>
              <div class="flex flex-col">
                <label for="contrat" class="mb-1 font-medium">Type Contrat</label>
                <p-select id="contrat" name="contrat" [(ngModel)]="contrat" [options]="contrats"
                  placeholder="Choisir un type" class="w-full" required [disabled]="consulter"></p-select>
              </div>
              <div class="flex flex-col">
                <label for="emp" class="mb-1 font-medium">Type Employeur</label>
                <p-select id="emp" name="emp" [(ngModel)]="employeur" [options]="employeurs"
                  placeholder="Choisir un type" class="w-full" required [disabled]="consulter"></p-select>
              </div>
            </div>
          </section>
          <section [hidden]="activeFieldset != 2">
            <h2 class="text-2xl font-bold text-surface-900 dark:text-white mb-6">Lignes Crédit</h2>
            <app-ligne-credit #ligneCreditComponent [recievedLigList]="ligList"></app-ligne-credit>
            <section>
              <div class="flex justify-center gap-6 mt-8">
                <button pButton type="button" label="Initialiser" class="p-button-outlined p-button-danger"
                  [disabled]="consulter"></button>
                <button pButton type="submit" (click)="enregistrer(false)" label="Enregistrer" class="p-button-primary"
                  [disabled]="consulter"></button>
                <button *ngIf="dossier.status!='ANALYSE GGR'" pButton type="button" label="Valider"
                  class="p-button-info"
                  [disabled]="this.valider || dossier.status=='ACCEPTEE'|| dossier.status=='REJETEE'"
                  (click)="enregistrer(true)"></button>
                <button *ngIf="dossier.status=='ANALYSE GGR'" pButton type="button" label="Accepter / Rejeter"
                  class="p-button-info" [disabled]="this.valider" (click)="accepter()"></button>
              </div>
            </section>
          </section>

        </div>
      </div>
    </div>
  </p-fluid>
</form>